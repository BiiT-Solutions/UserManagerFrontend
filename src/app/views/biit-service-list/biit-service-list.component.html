<ng-container *transloco="let t">
  <div class="table-view">
    <biit-datatable id="service-table" #table
                    [columns]="columns"
                    [data]="services"
                    [pageSize]="pageSize"
                    [pageSizeList]="pageSizes"
                    [loading]="loading"
                    selectable
    >
      <button id="button-plus" biit-icon icon="plus" *ngIf="Permission.SERVICES.CREATE | hasPermission"
              [title]="t('t.add')"
              (click)="onAdd()"
      ></button>
      <button id="button-minus" biit-icon icon="minus" *ngIf="Permission.SERVICES.DELETE | hasPermission"
              [title]="t('t.delete')"
              (click)="onDelete(table.selectedRows, false)"
              [disabled]="!table.selectedRows.length"
      ></button>
      <button id="button-edit" biit-icon icon="edit" *ngIf="Permission.SERVICES.EDIT | hasPermission"
              [title]="t('t.edit')"
              (click)="onEdit(table.selectedRows)"
              [disabled]="table.selectedRows.length !== 1"
      ></button>
      <button id="button-linkage" biit-icon icon="linkage" *ngIf="Permission.SERVICES.PERMISSIONS | hasPermission"
              [title]="t('t.assign')"
              (click)="onAssign(table.selectedRows)"
              [disabled]="table.selectedRows.length !== 1"
      ></button>
    </biit-datatable>
  </div>

  <biit-popup id="service-popup" *ngIf="editService"
              [title]="mode === 'EDIT' ? t('t.edit_service') : t('t.new_service')"
              (onClosed)="editService = null"
              closable sixty-view
  >
    <div class="form">
      <biit-input-text id="service-name" style="width: 100%"
                       [placeholder]="t('t.name')"
                       [(ngModel)]="editService.name"
                       [required]="true"
                       [disabled]="mode == 'EDIT'"
      />
      <biit-textarea id="service-description"
                     [(ngModel)]="editService.description"
                     [placeholder]="t('t.description')"
                     class="description"
      />
      <div class="form-bottom">
        <button id="popup-service-save-button" biit-button primary style="display: block" (click)="onSave()">
          {{ t('t.save') }}
        </button>
      </div>
    </div>

  </biit-popup>

  <biit-popup id="confirmation-delete-popup" *ngIf="confirm === 'DELETE'"
              dark-bg no-header
  >
    <div class="vertical">
      <div>{{ t('t.confirm_delete') }}</div>
      <div class="flex-grow horizontal buttons-row">
        <button id="confirm-cancel-button" biit-button secondary (click)="confirm = null">{{ t('t.cancel') }}</button>
        <button id="confirm-delete-button" biit-button primary (click)="onDelete(selected, true)">{{ t('t.delete') }}
        </button>
      </div>
    </div>

  </biit-popup>

  <biit-popup id="role-popup" *ngIf="assignService"
              [title]="assignService.name + ' ' + ('roles' | transloco)"
              (onClosed)="assignService = null"
              closable sixty-view
  >
    <biit-service-role-list [service]="assignService" style="width: 100%"/>
  </biit-popup>
</ng-container>
